theme(panel.grid = element_blank(),
text = element_blank(),
legend.title = element_text(size = 15),
plot.title = element_text(colour = "black", size = 20, hjust = 0.5))
# Save the plot
ggsave(filename = "piechart_cells_per_tissue.png", plot = plot4, path = output_directory, width = 8, height = 6, dpi = 300)
# --- Plot 5: Pie Chart - Cells per Platform ---
plot5 <- ggplot(datasets, aes(x = "", y = cells, fill = platform, color = stage1)) +
geom_col(width = 1) +
scale_fill_brewer(palette = "YlGnBu", name = "Platform")+
coord_polar("y") +
labs(title = "Cells per Platform") +
scale_color_manual(values = c("grey", "black"), name = "") +
theme_minimal() +
guides(color = "none") +
theme(panel.grid = element_blank(),
text = element_blank(),
legend.title = element_text(size = 15),
plot.title = element_text(colour = "black", size = 20, hjust = 0.5))
# Save the plot
ggsave(filename = "piechart_cells_per_platform.png", plot = plot5, path = output_directory, width = 8, height = 6, dpi = 300)
# --- Donut Plots using webr ---
# Data prep for donut plots
data <- datasets %>% group_by(platform, stage1) %>% summarise(n = sum(cells))
data$stage1 <- as.character(data$stage1)
data$stage1[is.na(data$stage1)] <- "full"
# --- Plot 6: Donut Plot 1 ---
# The PieDonut function also returns a ggplot object, so we can save it the same way
plot6 <- PieDonut(data, aes(platform, stage1, count=n), title = "Pilot: Cells per Platform",
showRatioDonut = FALSE, showRatioPie = FALSE,
showPieName = FALSE,
explodeDonut = TRUE,
donutLabelSize = 4,
selected = c(2,4))
# Save the plot
ggsave(filename = "donut_platform_stage.png", plot = plot6, path = output_directory, width = 8, height = 8, dpi = 300)
# --- Plot 7: Donut Plot 2 ---
plot7 <- PieDonut(data, aes(stage1, platform, count=n), title = "Pilot: Cells per Platform",
ratioByGroup = FALSE,
showRatioDonut = FALSE, showRatioPie = FALSE, showPieName = FALSE, labelposition = 1,
explode = 2)
# Save the plot
ggsave(filename = "donut_stage_platform.png", plot = plot7, path = output_directory, width = 8, height = 8, dpi = 300)
# Optional: Print a message when done
print(paste("All 7 plots have been saved to:", output_directory))
output_directory <- "/Users/lukashat/Documents/PhD_Schapiro/Projects/phenotype_benchmark/stage_1"
# Load libraries
library(tidyverse)
library(ggplot2)
library(webr)
# --- Data Preparation ---
datasets <- tibble(
platform = c(rep("MIBI", 2), rep("CODEX", 1), rep("IMC", 1), rep("Lunaphore", 1), "CODEX", "MIBI", rep("IMC", 2)),
cells = c(1669853, 230895, 145161,100000,100000, 1200000, 500000, 553121, 457117),
tissue = c(rep("Lymph node", 3), "Bone marrow","Heart", "Bone marrow", "Decidua", "Breast",  "Multiple"),
stage1 = c("remaining", "pilot", rep("remaining", 6), "pilot")
)
datasets$platform <- factor(datasets$platform, levels = c("MIBI", "IMC","CODEX",  "Lunaphore"))
datasets$tissue <- factor(datasets$tissue, levels = c("Lymph node", "Bone marrow", "Breast", "Decidua", "Multiple","Heart"))
datasets$stage1 <- factor(datasets$stage1, levels = c("remaining", "pilot"))
# --- Plot 1: Barplot - Cells per Platform ---
plot1 <- ggplot(datasets, aes(platform, cells, fill = stage1)) +
geom_col(position = "stack", width = 0.8, color = "#3E424B") +
scale_fill_manual(values = c( "grey", "#7AA2C4")) + #46a2da #006884
theme_classic() +
theme(panel.grid.major.y = element_line(size = 0.5, colour = "lightgrey"),
text = element_text(size = 20),
axis.text = element_text(colour = "black"),
legend.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(colour = "black", size = 20))+ #363636
#guides(fill = "none") +
labs(x = "Platform", y = "cells", title = "Cells per Platform")
# Save the plot
ggsave(filename = "barplot_cells_per_platform.svg", plot = plot1, path = output_directory, width = 8, height = 6, dpi = 300)
# --- Plot 2: Barplot - Cells per Tissue ---
plot2 <- ggplot(datasets, aes(tissue, cells, fill = stage1)) +
geom_col(position = "stack", width = 0.8, color = "#3E424B") +
scale_fill_manual(values = c( "grey", "#7AA2C4")) +
theme_classic() +
theme(panel.grid.major.y = element_line(size = 0.5, colour = "lightgrey"),
text = element_text(size = 20),
axis.text = element_text(colour = "black"),
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(colour = "black", size = 20))+ #363636
guides(fill = "none") +
labs(x = "Tissue", y = "cells", title = "Cells per Tissue")
# Save the plot
ggsave(filename = "barplot_cells_per_tissue.svg", plot = plot2, path = output_directory, width = 8, height = 6, dpi = 300)
# --- Plot 3: Radial Plot ---
plot3 <- ggplot(datasets, aes(tissue, cells, fill = stage1)) +
geom_col(position = "stack", width = 0.8, color = "#3E424B") +
scale_fill_manual(values = c( "grey", "#7AA2C4")) +
theme_classic() +
theme(panel.grid.major.y = element_line(size = 0.5, colour = "lightgrey"),
text = element_text(size = 20),
axis.text = element_text(colour = "black"),
axis.text.x = element_text(angle = 45, hjust = 1),
plot.title = element_text(colour = "black", size = 20))+ #363636
guides(fill = "none") +
labs(x = "Tissue", y = "cells", title = "Cells per Tissue") +
coord_radial(theta = "x")
# Save the plot
ggsave(filename = "radial_plot_cells_per_tissue.svg", plot = plot3, path = output_directory, width = 8, height = 8, dpi = 300)
# --- Plot 4: Pie Chart - Cells per Tissue ---
plot4 <- ggplot(datasets, aes(x = "", y = cells, fill = tissue, color = stage1)) +
geom_col(width = 1) +
scale_fill_brewer(palette = "YlGnBu", name = "Tissue")+
coord_polar("y") +
labs(title = "Cells per Tissue") +
scale_color_manual(values = c("grey", "black"), name = "") +
theme_minimal() +
guides(color = "none") +
theme(panel.grid = element_blank(),
text = element_blank(),
legend.title = element_text(size = 15),
plot.title = element_text(colour = "black", size = 20, hjust = 0.5))
# Save the plot
ggsave(filename = "piechart_cells_per_tissue.svg", plot = plot4, path = output_directory, width = 8, height = 6, dpi = 300)
# --- Plot 5: Pie Chart - Cells per Platform ---
plot5 <- ggplot(datasets, aes(x = "", y = cells, fill = platform, color = stage1)) +
geom_col(width = 1) +
scale_fill_brewer(palette = "YlGnBu", name = "Platform")+
coord_polar("y") +
labs(title = "Cells per Platform") +
scale_color_manual(values = c("grey", "black"), name = "") +
theme_minimal() +
guides(color = "none") +
theme(panel.grid = element_blank(),
text = element_blank(),
legend.title = element_text(size = 15),
plot.title = element_text(colour = "black", size = 20, hjust = 0.5))
# Save the plot
ggsave(filename = "piechart_cells_per_platform.svg", plot = plot5, path = output_directory, width = 8, height = 6, dpi = 300)
# --- Donut Plots using webr ---
# Data prep for donut plots
data <- datasets %>% group_by(platform, stage1) %>% summarise(n = sum(cells))
data$stage1 <- as.character(data$stage1)
data$stage1[is.na(data$stage1)] <- "full"
# --- Plot 6: Donut Plot 1 ---
# The PieDonut function also returns a ggplot object, so we can save it the same way
plot6 <- PieDonut(data, aes(platform, stage1, count=n), title = "Pilot: Cells per Platform",
showRatioDonut = FALSE, showRatioPie = FALSE,
showPieName = FALSE,
explodeDonut = TRUE,
donutLabelSize = 4,
selected = c(2,4))
# Save the plot
ggsave(filename = "donut_platform_stage.svg", plot = plot6, path = output_directory, width = 8, height = 8, dpi = 300)
# --- Plot 7: Donut Plot 2 ---
plot7 <- PieDonut(data, aes(stage1, platform, count=n), title = "Pilot: Cells per Platform",
ratioByGroup = FALSE,
showRatioDonut = FALSE, showRatioPie = FALSE, showPieName = FALSE, labelposition = 1,
explode = 2)
# Save the plot
ggsave(filename = "donut_stage_platform.svg", plot = plot7, path = output_directory, width = 8, height = 8, dpi = 300)
# Optional: Print a message when done
print(paste("All 7 plots have been saved to:", output_directory))
#install.packages("funkyheatmap")
library(funkyheatmap)
#install.packages("funkyheatmap")
library(funkyheatmap)
install.packages("funkyheatmap")
#install.packages("funkyheatmap")
library(funkyheatmap)
library(dplyr, warn.conflicts = FALSE)
library(tibble, warn.conflicts = FALSE)
library(readr)
library(RColorBrewer)
library(ggplot2)
library(colorspace)
results <- read_delim("/Users/lukashat/Downloads/final_results_averaged.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
#old <- read_csv("Documents/uni/PhD/pheno_benchmark/results/results_lvl3.csv")
results <- results[ , c("method", "F1 Weighted","Hierarchical F1", "Macro F1",  "MCC", "ARI", "JSD Scaled", "Performance Overall" ,"Stability", "Scalability")]
results$`Performance Overall` <- round(results$`Performance Overall`, 3)
colnames(results)[colnames(results) == "method"] <- "id"
rcinfo <- tibble(
id = colnames(results),
group = c(NA, rep("Classical Performance", 4), rep("Celltype Composition", 2), "Overall Performance", rep("Computation", 2)),
options = lapply(seq(10), function(x) lst()),
name = c("", "Weighted F1", "Hierarchical F1", "Macro F1", "MCC", "ARI", "Sccaled JSD", "Overall Performance", "Stability", "Scalability"),
palette = c(NA, rep("CP_palette", 4), rep("Composition_palette", 2), "overall_palette",  rep("Computation_palette", 2)),
geom = c("text", "circle","circle", "circle", "circle", "funkyrect", "funkyrect", "bar", "rect", "rect"),
width = c(6, 1, 1, 1, 1,1,1,4,1,1),
hjust = c(0,NA,NA,NA,NA,NA,NA,NA,NA,NA)
)
rcinfo <- rcinfo %>%
add_row(id = "Performance Overall", group = "Overall Performance", name = "", geom = "text", options = lst(lst(overlay = TRUE)), palette = NA, .before = 9, width = 1, hjust = 0.95)
palettes <- list(overall_palette = rev(sequential_hcl(8, "BuGn")), Composition_palette = brewer.pal(9, "PuBu")[-1], CP_palette = brewer.pal(9, "RdPu")[-1], Computation_palette = rev(sequential_hcl(8, "Peach")))
palettes$funky_palette_grey <- RColorBrewer::brewer.pal(9, "Greys")[-1]
column_groups <- tibble(
Category = c("Overall Performance", "Classical Performance", "Celltype Composition", "Computation"),
group = c("Overall Performance", "Classical Performance", "Celltype Composition", "Computation"),
palette = c("overall_palette", "CP_palette", "Composition_palette", "Computation_palette")
)
legends <- list(
list(
palette = "overall_palette",
geom = "bar",
title = "Overall",
labels = c(0, rep("", 7), 1)
),
list(
palette = "CP_palette",
geom = "circle",
title = "Classical Performance",
labels = c("",0, rep("", 7), 1)
),
list(
palette = "Composition_palette",
geom = "funkyrect",
title = "Celltype Composition",
labels = c("",0, rep("", 7), 1) ,
enabled = TRUE
),
list(
palette = "Computation_palette",
geom = "rect",
title = "Computation",
size = c(rep(1,5)),
labels = c(0, rep("", 3), 1),
enabled = TRUE
),
list(
palette = "funky_palette_grey",
geom = "funkyrect",
title = "Overall",
enabled = FALSE,
labels = c("0", "", "0.2", "", "0.4", "", "0.6", "", "0.8", "", "1")
)
)
row_info <- tibble(id = results$id, group = c(rep("Supervised",4), "Unsupervised", "Prior-Knowledge Driven", rep("Unsupervised",2), "Prior-Knowledge Driven","Unsupervised",rep("Prior-Knowledge Driven",3), "Pre-Trained Models", rep("Unsupervised",3), "Pre-Trained Models", "Baseline", "Pre-Trained Models", "Baseline"))
View(results)
#install.packages("funkyheatmap")
library(funkyheatmap)
library(dplyr, warn.conflicts = FALSE)
library(tibble, warn.conflicts = FALSE)
library(readr)
library(RColorBrewer)
library(ggplot2)
library(colorspace)
results <- read_delim("/Users/lukashat/Downloads/final_results_averaged.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
View(results)
results <- read_delim("/Users/lukashat/Downloads/final_results_averaged.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
#old <- read_csv("Documents/uni/PhD/pheno_benchmark/results/results_lvl3.csv")
results <- results[ , c("method", "F1 Weighted","Hierarchical F1", "Macro F1",  "MCC", "ARI", "JSD Scaled", "Performance Overall" ,"Stability", "Scalability")]
results$`Performance Overall` <- round(results$`Performance Overall`, 3)
colnames(results)[colnames(results) == "method"] <- "id"
rcinfo <- tibble(
id = colnames(results),
group = c(NA, rep("Classical Performance", 4), rep("Celltype Composition", 2), "Overall Performance", rep("Computation", 2)),
options = lapply(seq(10), function(x) lst()),
name = c("", "Weighted F1", "Hierarchical F1", "Macro F1", "MCC", "ARI", "Sccaled JSD", "Overall Performance", "Stability", "Scalability"),
palette = c(NA, rep("CP_palette", 4), rep("Composition_palette", 2), "overall_palette",  rep("Computation_palette", 2)),
geom = c("text", "circle","circle", "circle", "circle", "funkyrect", "funkyrect", "bar", "rect", "rect"),
width = c(6, 1, 1, 1, 1,1,1,4,1,1),
hjust = c(0,NA,NA,NA,NA,NA,NA,NA,NA,NA)
)
rcinfo <- rcinfo %>%
add_row(id = "Performance Overall", group = "Overall Performance", name = "", geom = "text", options = lst(lst(overlay = TRUE)), palette = NA, .before = 9, width = 1, hjust = 0.95)
palettes <- list(overall_palette = rev(sequential_hcl(8, "BuGn")), Composition_palette = brewer.pal(9, "PuBu")[-1], CP_palette = brewer.pal(9, "RdPu")[-1], Computation_palette = rev(sequential_hcl(8, "Peach")))
palettes$funky_palette_grey <- RColorBrewer::brewer.pal(9, "Greys")[-1]
column_groups <- tibble(
Category = c("Overall Performance", "Classical Performance", "Celltype Composition", "Computation"),
group = c("Overall Performance", "Classical Performance", "Celltype Composition", "Computation"),
palette = c("overall_palette", "CP_palette", "Composition_palette", "Computation_palette")
)
legends <- list(
list(
palette = "overall_palette",
geom = "bar",
title = "Overall",
labels = c(0, rep("", 7), 1)
),
list(
palette = "CP_palette",
geom = "circle",
title = "Classical Performance",
labels = c("",0, rep("", 7), 1)
),
list(
palette = "Composition_palette",
geom = "funkyrect",
title = "Celltype Composition",
labels = c("",0, rep("", 7), 1) ,
enabled = TRUE
),
list(
palette = "Computation_palette",
geom = "rect",
title = "Computation",
size = c(rep(1,5)),
labels = c(0, rep("", 3), 1),
enabled = TRUE
),
list(
palette = "funky_palette_grey",
geom = "funkyrect",
title = "Overall",
enabled = FALSE,
labels = c("0", "", "0.2", "", "0.4", "", "0.6", "", "0.8", "", "1")
)
)
row_info <- tibble(id = results$id, group = c(rep("Supervised",4), "Unsupervised", "Prior-Knowledge Driven", rep("Unsupervised",3), "Prior-Knowledge Driven",rep("Unsupervised",2),rep("Prior-Knowledge Driven",1), "Pre-Trained Models", "Prior-Knowledge Driven","Unsupervised", "Pre-Trained Models", "Baseline","Pre-Trained Models", "Baseline"))
row_info$group <- factor(row_info$group, levels = c( "Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"))
results <- results[order(row_info$group), ]
row_info <- row_info[order(row_info$group), ]
row_groups <- tibble(level1 = c("Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"), group = c("Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"))
funky_heatmap(results,
column_info = rcinfo,
column_groups = column_groups,
palettes = palettes,
legends = legends,
scale_column = FALSE,
row_info = row_info,
row_groups = row_groups)
p <- funky_heatmap(results,
column_info = rcinfo,
column_groups = column_groups,
palettes = palettes,
legends = legends,
scale_column = FALSE,
row_info = row_info,
row_groups = row_groups)
ggsave(
filename = "/Users/lukashat/Documents/PhD_Schapiro/Projects/phenotype_benchmark/stage_1/funky_heatmap.svg",
plot = p,
width = 14,       # width in inches
height = 10,      # height in inches
dpi = 300,        # resolution in dots per inch     # specify a background color
)
setwd("~/Documents/PhD_Schapiro/Projects/phenotype_benchmark/github/pheno_benchmark_small/src/plotting")
#install.packages("funkyheatmap")
library(funkyheatmap)
library(dplyr, warn.conflicts = FALSE)
library(tibble, warn.conflicts = FALSE)
library(readr)
library(RColorBrewer)
library(ggplot2)
library(colorspace)
results <- read_delim("final_results_averaged.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
#old <- read_csv("Documents/uni/PhD/pheno_benchmark/results/results_lvl3.csv")
results <- results[ , c("method", "Weighted F1","Hierarchical F1", "Macro F1",  "MCC", "ARI", "JSD Scaled", "Overall Performance" ,"Stability", "Scalability")]
results$`Overall Performance` <- round(results$`Overall Performance`, 3)
colnames(results)[colnames(results) == "method"] <- "id"
results$Scalability[results$id == 'Deepcelltypes_adapted'] <- results$Scalability[results$id == 'Deepcelltypes']
results$Scalability[results$id == 'RIBCA_adapted'] <- results$Scalability[results$id == 'RIBCA']
rcinfo <- tibble(
id = colnames(results),
group = c(NA, rep("Classification Performance", 4), rep("Celltype Composition", 2), "Overall Performance", rep("Computation", 2)),
options = lapply(seq(10), function(x) lst()),
name = c("", "Weighted F1", "Hierarchical F1", "Macro F1", "MCC", "ARI", "JSD Scaled", "Overall Performance", "Stability", "Scalability"),
palette = c(NA, rep("CP_palette", 4), rep("Composition_palette", 2), "overall_palette",  rep("Computation_palette", 2)),
geom = c("text", "circle","circle", "circle", "circle", "funkyrect", "funkyrect", "bar", "rect", "rect"),
width = c(7, 1, 1, 1, 1,1,1,4,1,1),
hjust = c(0,NA,NA,NA,NA,NA,NA,NA,NA,NA)
)
rcinfo <- rcinfo %>%
add_row(id = "Overall Performance", group = "Overall Performance", name = "", geom = "text", options = lst(lst(overlay = TRUE)), palette = NA, .before = 9, width = 1, hjust = 0.95)
palettes <- list(overall_palette = rev(sequential_hcl(8, "BuGn")), Composition_palette = brewer.pal(9, "PuBu")[-1], CP_palette = brewer.pal(9, "RdPu")[-1], Computation_palette = rev(sequential_hcl(8, "Peach")))
palettes$funky_palette_grey <- RColorBrewer::brewer.pal(9, "Greys")[-1]
column_groups <- tibble(
Category = c("Overall Performance", "Classification Performance", "Celltype Composition", "Computation"),
group = c("Overall Performance", "Classification Performance", "Celltype Composition", "Computation"),
palette = c("overall_palette", "CP_palette", "Composition_palette", "Computation_palette")
)
legends <- list(
list(
palette = "overall_palette",
geom = "bar",
title = "Overall",
labels = c(0, rep("", 7), 1)
),
list(
palette = "CP_palette",
geom = "circle",
title = "Classification Performance",
labels = c("",0, rep("", 7), 1)
),
list(
palette = "Composition_palette",
geom = "funkyrect",
title = "Celltype Composition",
labels = c("",0, rep("", 7), 1) ,
enabled = TRUE
),
list(
palette = "Computation_palette",
geom = "rect",
title = "Computation",
size = c(rep(1,5)),
labels = c(0, rep("", 3), 1),
enabled = TRUE
),
list(
palette = "funky_palette_grey",
geom = "funkyrect",
title = "Overall",
enabled = FALSE,
labels = c("0", "", "0.2", "", "0.4", "", "0.6", "", "0.8", "", "1")
)
)
row_info <- tibble(id = results$id, group = c(rep("Supervised",5), "Unsupervised", "Prior-Knowledge Driven", rep("Unsupervised",3), "Prior-Knowledge Driven",rep("Unsupervised",2),"Prior-Knowledge Driven", "Pre-Trained Models", "Prior-Knowledge Driven", "Pre-Trained Models", "Unsupervised", rep("Pre-Trained Models",2), "Baseline", "Pre-Trained Models","Baseline"))
row_info$group <- factor(row_info$group, levels = c( "Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"))
results <- results[order(row_info$group), ]
row_info <- row_info[order(row_info$group), ]
row_groups <- tibble(level1 = c("Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"), group = c("Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"))
p = funky_heatmap(results,
column_info = rcinfo,
column_groups = column_groups,
palettes = palettes,
legends = legends,
scale_column = FALSE,
row_info = row_info,
row_groups = row_groups)
ggsave(
filename = "figure_plots/funky_heatmap.svg",
plot = p,
width = 15,       # width in inches
height = 10,      # height in inches
dpi = 300,        # resolution in dots per inch     # specify a background color
)
#install.packages("funkyheatmap")
library(funkyheatmap)
library(dplyr, warn.conflicts = FALSE)
library(tibble, warn.conflicts = FALSE)
library(readr)
library(RColorBrewer)
library(ggplot2)
library(colorspace)
results <- read_delim("final_results_averaged.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)
#old <- read_csv("Documents/uni/PhD/pheno_benchmark/results/results_lvl3.csv")
results <- results[ , c("method", "Weighted F1","Hierarchical F1", "Macro F1",  "MCC", "ARI", "JSD Scaled", "Overall Performance" ,"Stability", "Scalability")]
results$`Overall Performance` <- round(results$`Overall Performance`, 3)
colnames(results)[colnames(results) == "method"] <- "id"
results$Scalability[results$id == 'Deepcelltypes_adapted'] <- results$Scalability[results$id == 'Deepcelltypes']
results$Scalability[results$id == 'RIBCA_adapted'] <- results$Scalability[results$id == 'RIBCA']
rcinfo <- tibble(
id = colnames(results),
group = c(NA, rep("Classification Performance", 4), rep("Celltype Composition", 2), "Overall Performance", rep("Computation", 2)),
options = lapply(seq(10), function(x) lst()),
name = c("", "Weighted F1", "Hierarchical F1", "Macro F1", "MCC", "ARI", "JSD Scaled", "Overall Performance", "Stability", "Scalability"),
palette = c(NA, rep("CP_palette", 4), rep("Composition_palette", 2), "overall_palette",  rep("Computation_palette", 2)),
geom = c("text", "circle","circle", "circle", "circle", "funkyrect", "funkyrect", "bar", "rect", "rect"),
width = c(7, 1, 1, 1, 1,1,1,4,1,1),
hjust = c(0,NA,NA,NA,NA,NA,NA,NA,NA,NA)
)
rcinfo <- rcinfo %>%
add_row(id = "Overall Performance", group = "Overall Performance", name = "", geom = "text", options = lst(lst(overlay = TRUE)), palette = NA, .before = 9, width = 1, hjust = 0.95)
palettes <- list(overall_palette = rev(sequential_hcl(8, "BuGn")), Composition_palette = brewer.pal(9, "PuBu")[-1], CP_palette = brewer.pal(9, "RdPu")[-1], Computation_palette = rev(sequential_hcl(8, "Peach")))
palettes$funky_palette_grey <- RColorBrewer::brewer.pal(9, "Greys")[-1]
column_groups <- tibble(
Category = c("Overall Performance", "Classification Performance", "Celltype Composition", "Computation"),
group = c("Overall Performance", "Classification Performance", "Celltype Composition", "Computation"),
palette = c("overall_palette", "CP_palette", "Composition_palette", "Computation_palette")
)
legends <- list(
list(
palette = "overall_palette",
geom = "bar",
title = "Overall",
labels = c(0, rep("", 7), 1)
),
list(
palette = "CP_palette",
geom = "circle",
title = "Classification Performance",
labels = c("",0, rep("", 7), 1)
),
list(
palette = "Composition_palette",
geom = "funkyrect",
title = "Celltype Composition",
labels = c("",0, rep("", 7), 1) ,
enabled = TRUE
),
list(
palette = "Computation_palette",
geom = "rect",
title = "Computation",
size = c(rep(1,5)),
labels = c(0, rep("", 3), 1),
enabled = TRUE
),
list(
palette = "funky_palette_grey",
geom = "funkyrect",
title = "Overall",
enabled = FALSE,
labels = c("0", "", "0.2", "", "0.4", "", "0.6", "", "0.8", "", "1")
)
)
row_info <- tibble(id = results$id, group = c(rep("Supervised",5), "Unsupervised", "Prior-Knowledge Driven", rep("Unsupervised",3), "Prior-Knowledge Driven",rep("Unsupervised",2),"Prior-Knowledge Driven", "Pre-Trained Models", "Prior-Knowledge Driven", "Pre-Trained Models", "Unsupervised", rep("Pre-Trained Models",2), "Baseline", "Pre-Trained Models","Baseline"))
row_info$group <- factor(row_info$group, levels = c( "Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"))
results <- results[order(row_info$group), ]
row_info <- row_info[order(row_info$group), ]
row_groups <- tibble(level1 = c("Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"), group = c("Supervised", "Unsupervised", "Prior-Knowledge Driven", "Pre-Trained Models", "Baseline"))
p = funky_heatmap(results,
column_info = rcinfo,
column_groups = column_groups,
palettes = palettes,
legends = legends,
scale_column = FALSE,
row_info = row_info,
row_groups = row_groups)
ggsave(
filename = "figure_plots/funky_heatmap.svg",
plot = p,
width = 15,       # width in inches
height = 10,      # height in inches
dpi = 300,        # resolution in dots per inch     # specify a background color
)
